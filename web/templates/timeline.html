{% extends 'base.html' %}

{% block title %}Timeline{% endblock %}

{% block extra_head %}
<link rel="stylesheet" href="/static/styles/timeline.css">
{% endblock %}

{% block extra_styles %}
{# CSS moved to /static/styles/timeline.css #}
{% endblock %}

{% block content %}
        <div class="timeline-wrapper">
            <div class="timeline-layout">
            <div class="sidebar-panel">
                <!-- Collapsible Calendar Section (expanded by default) -->
                <div class="calendar-section">
                    <button class="calendar-toggle" id="calendarToggle" aria-expanded="true" title="Click to collapse/expand calendar">
                        <span class="toggle-icon">‚ñº</span>
                        <span id="monthDisplay">Loading...</span>
                    </button>

                    <div class="calendar-content" id="calendarContent">
                        <div class="calendar-controls">
                            <div class="view-toggle">
                                <button class="view-btn active" id="viewMonth" data-view="month">Month</button>
                                <button class="view-btn" id="viewWeek" data-view="week">Week</button>
                            </div>
                            <div class="nav-controls">
                                <button id="prevMonth" title="Previous month (H key)">‚Üê</button>
                                <a href="#" id="todayNav" class="today-link">Today</a>
                                <button id="nextMonth" title="Next month (L key)">‚Üí</button>
                            </div>
                        </div>

                        <div class="calendar-weekdays">
                            <div class="weekday">Sun</div>
                            <div class="weekday">Mon</div>
                            <div class="weekday">Tue</div>
                            <div class="weekday">Wed</div>
                            <div class="weekday">Thu</div>
                            <div class="weekday">Fri</div>
                            <div class="weekday">Sat</div>
                        </div>
                        <div class="calendar-grid" id="calendarGrid">
                            <div class="loading">
                                <div class="spinner"></div>
                                <div>Loading calendar...</div>
                            </div>
                        </div>
                        <div class="calendar-legend">
                            <span>Less</span>
                            <div class="legend-item" style="background: var(--intensity-0);"></div>
                            <div class="legend-item" style="background: var(--intensity-1);"></div>
                            <div class="legend-item" style="background: var(--intensity-2);"></div>
                            <div class="legend-item" style="background: var(--intensity-3);"></div>
                            <div class="legend-item" style="background: var(--intensity-4);"></div>
                            <span>More</span>
                            <span class="info-icon">?
                                <span class="info-tooltip">Activity intensity is based on the number of screenshots captured. Darker colors indicate more activity.</span>
                            </span>
                        </div>

                        <!-- Week View Panel (hidden by default) -->
                        <div id="weekViewPanel" class="week-view-panel" style="display: none;">
                            <div class="week-days-strip" id="weekDaysStrip"></div>
                        </div>
                    </div>
                </div>

                <!-- Day Overview (below calendar) -->
                <div id="leftChartSection" style="display: none;">
                    <div class="detail-stats" id="detailStats"></div>
                    <div id="tagsSection" class="tags-section" style="display: none;">
                        <h3>Tags</h3>
                        <div id="tagsList" class="tags-list"></div>
                    </div>
                </div>
            </div>

            <div class="detail-panel">
                <div class="detail-header">
                    <div class="date-selector">
                        <button id="prevDayBtn" title="Previous day">‚Üê</button>
                        <h2 id="selectedDate">Select a day</h2>
                        <button id="nextDayBtn" title="Next day">‚Üí</button>
                        <input type="date" id="datePickerInput" class="date-picker-input"
                               title="Jump to date" aria-label="Jump to specific date">
                    </div>
                </div>

                <div id="detailContent" class="detail-content-wrapper">
                    <div class="empty-state">
                        <div class="empty-state-icon">üìÖ</div>
                        <p>Click a day on the calendar to view activity</p>
                    </div>
                </div>
            </div>
        </div>
        </div>
    </div>

    <div class="keyboard-hint">
        <kbd>‚Üê</kbd> <kbd>‚Üí</kbd> <kbd>‚Üë</kbd> <kbd>‚Üì</kbd> Navigate days
        <span style="margin: 0 10px;">|</span>
        <kbd>H</kbd> Prev month <kbd>L</kbd> Next month
    </div>
    <!-- Screenshot modal is included from base.html -->
{% endblock %}

{% block extra_scripts %}
<script src="/static/js/timeline.js"></script>
{% endblock %}
