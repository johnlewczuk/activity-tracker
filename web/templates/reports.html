{% extends "base.html" %}
{% set page = 'reports' %}

{% block title %}Reports - Activity Tracker{% endblock %}

{% block extra_head %}
<link rel="stylesheet" href="/static/styles/reports.css">
{% endblock %}

{% block extra_styles %}
{# CSS moved to /static/styles/reports.css #}
{% endblock %}

{% block content %}
<!-- Quick Presets -->
<div class="section">
    <h2>Quick Reports</h2>
    <div class="preset-grid">
        <button class="preset-btn" data-range="today" data-type="summary">Today</button>
        <button class="preset-btn" data-range="yesterday" data-type="summary">Yesterday</button>
        <button class="preset-btn" data-range="this week" data-type="summary">This Week</button>
        <button class="preset-btn" data-range="last week" data-type="detailed">Last Week</button>
        <button class="preset-btn standup" data-range="since this morning" data-type="standup">Standup (Today)</button>
        <button class="preset-btn standup" data-range="yesterday" data-type="standup">Standup (Yesterday)</button>
    </div>
</div>

<!-- Custom Report -->
<div class="section">
    <h2>Custom Report</h2>
    <div class="custom-form">
        <div class="form-row">
            <div class="form-group">
                <label for="time-range">Time Range</label>
                <input type="text" id="time-range"
                       placeholder="e.g., last 3 days, Dec 1 to Dec 5, this month">
                <div class="hint">Natural language: "yesterday", "last week", "past 2 hours"</div>
            </div>
            <div class="form-group">
                <label for="report-type">Report Type</label>
                <select id="report-type">
                    <option value="summary">Summary (high-level overview)</option>
                    <option value="detailed">Detailed (day-by-day breakdown)</option>
                    <option value="standup">Standup (brief bullet points)</option>
                </select>
            </div>
        </div>
        <div class="form-group checkbox-group">
            <input type="checkbox" id="include-screenshots" checked>
            <label for="include-screenshots">Include key screenshots</label>
        </div>
        <button id="generate-btn" class="primary-btn">Generate Report</button>
    </div>
</div>

<!-- Report Display -->
<div class="report-container" id="report-container" style="display: none;">
    <div class="report-header">
        <div>
            <h2 id="report-title"></h2>
            <div class="report-meta" id="report-meta"></div>
        </div>
        <div class="report-actions">
            <button class="export-btn" data-format="markdown">Markdown</button>
            <button class="export-btn" data-format="html">HTML</button>
            <button class="export-btn" data-format="pdf">PDF</button>
            <button class="export-btn" data-format="json">JSON</button>
        </div>
    </div>

    <!-- Analytics Cards -->
    <div class="analytics-grid" id="analytics-grid"></div>

    <!-- Top Apps -->
    <div class="top-apps" id="top-apps"></div>

    <!-- Executive Summary -->
    <div class="summary-card" id="executive-summary"></div>

    <!-- Sections -->
    <div id="report-sections"></div>

    <!-- Screenshots -->
    <div class="screenshots-section" id="screenshots-section" style="display: none;">
        <h3>Key Screenshots</h3>
        <div class="screenshot-grid" id="screenshot-grid"></div>
    </div>
</div>

<!-- Saved Reports (cached daily reports) -->
<div class="section" id="saved-reports-section">
    <h2>Daily Summaries</h2>
    <p class="section-desc">Auto-generated daily reports from AI summaries. Click to view and export.</p>
    <div id="saved-reports-list">
        <div class="empty-state" id="saved-empty">
            <div class="empty-state-icon">üìä</div>
            <p>No daily summaries yet. These are auto-generated from your activity data.</p>
        </div>
    </div>
</div>

<!-- Report History (exported files) -->
<div class="section" id="history-section">
    <h2>Recent Exports</h2>
    <div id="history-list">
        <div class="empty-state" id="history-empty">
            <div class="empty-state-icon">üìÅ</div>
            <p>No exported reports yet</p>
        </div>
    </div>
</div>

<!-- Loading Overlay -->
<div class="loading-overlay" id="loading" style="display: none;">
    <div class="spinner"></div>
    <div class="loading-text">Generating report...</div>
</div>
{% endblock %}

{% block extra_scripts %}
<script src="/static/js/reports.js"></script>
{% endblock %}
