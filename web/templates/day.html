{% extends "base.html" %}

{% block title %}Activity Tracker - {{ date.strftime('%Y-%m-%d') }}{% endblock %}

{% block extra_head %}
<link rel="stylesheet" href="/static/styles/day.css">
{% endblock %}

{% block extra_styles %}
{# CSS moved to /static/styles/day.css #}
{% endblock %}

{% block content %}
<div class="day-header">
    <h1 class="day-title">{{ date.strftime('%A, %B %d, %Y') }}</h1>
    <div class="day-nav">
        <a href="/day/{{ (date - timedelta(days=1)).strftime('%Y-%m-%d') }}">‚Üê Previous</a>
        <a href="/day/{{ (date + timedelta(days=1)).strftime('%Y-%m-%d') }}">Next ‚Üí</a>
        <button id="collapseAllBtn" class="collapse-btn">Collapse All</button>
        <a href="/timeline" class="timeline-link">View in Timeline</a>
    </div>
</div>

{% if screenshots %}
    <div id="hourlyGroups">
        <!-- Will be populated by JavaScript -->
    </div>

    <!-- Image Modal -->
    <div id="imageModal" class="modal">
        <span class="modal-close">&times;</span>
        <div class="modal-content">
            <div class="modal-nav modal-nav-prev" id="modalPrev">&lsaquo;</div>
            <img id="modalImage" class="modal-image" alt="Full size screenshot">
            <div class="modal-nav modal-nav-next" id="modalNext">&rsaquo;</div>
        </div>
        <div class="modal-info">
            <div class="modal-metadata">
                <div class="modal-meta-item">
                    <span class="modal-meta-label">Counter</span>
                    <span class="modal-meta-value modal-counter" id="modalCounter">1 / 1</span>
                </div>
                <div class="modal-meta-item">
                    <span class="modal-meta-label">Time</span>
                    <span class="modal-meta-value" id="modalTime">--:--:--</span>
                </div>
                <div class="modal-meta-item">
                    <span class="modal-meta-label">Application</span>
                    <span class="modal-meta-value" id="modalApp">Unknown</span>
                </div>
                <div class="modal-meta-item" id="modalWindowTitleContainer" style="display: none;">
                    <span class="modal-meta-label">Window Title</span>
                    <span class="modal-meta-value" id="modalWindowTitle">--</span>
                </div>
            </div>
            <div class="modal-shortcuts">
                <span class="shortcut-key">&larr;</span> / <span class="shortcut-key">&rarr;</span> Navigate
                &nbsp;&nbsp;|&nbsp;&nbsp;
                <span class="shortcut-key">Esc</span> Close
            </div>
        </div>
    </div>

    <!-- Pass screenshots data to JavaScript -->
    <script type="application/json" id="screenshots-data">{{ screenshots | tojson }}</script>
{% else %}
    <div class="empty-state">
        <div class="empty-state-icon">üí§</div>
        <h2>No screenshots found</h2>
        <p>No activity captured for {{ date.strftime('%B %d, %Y') }}.</p>
        {% if date == today %}
            <p>Make sure the tracker service is running.</p>
        {% endif %}
    </div>
{% endif %}
{% endblock %}

{% block extra_scripts %}
{% if screenshots %}
<script src="/static/js/day.js"></script>
{% endif %}
{% endblock %}
